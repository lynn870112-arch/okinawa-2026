<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ²–ç¹©2026">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/826/826070.png">
    <link rel="manifest" href="manifest.json">
    <title>æ²–ç¹©æ¥µè‡´ä¹‹æ—… 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@700&family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #fcfaf2; color: #4a4a4a; -webkit-tap-highlight-color: transparent; }
        h2, .font-serif { font-family: 'Noto Serif TC', serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .date-item { opacity: 0.3; transition: all 0.3s ease; }
        .active-date { opacity: 1 !important; transform: translateY(-2px); }
        .active-date .date-num { color: #e53e3e !important; font-weight: 800; }
        .date-dot { width: 4px; height: 4px; border-radius: 50%; background-color: transparent; margin: 4px auto 0; }
        .active-date .date-dot { background-color: #e53e3e; }
        .timeline-wrapper { position: relative; width: 100%; }
        .timeline-line { position: absolute; left: 19px; top: 10px; bottom: 20px; width: 2px; background-color: #e2e8f0; z-index: 0; }
        .timeline-dot { z-index: 10; background-color: #fff; border: 2px solid #e53e3e; width: 12px; height: 12px; border-radius: 50%; position: absolute; left: 14px; top: 8px; }
        .sub-card { background-color: #ffffff; border-left: 4px solid #fca5a5; margin-left: 1rem; margin-top: 0.5rem; padding: 0.7rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.03); cursor: pointer; }
        .nav-btn-active { color: #e53e3e !important; }
        .weather-badge { background: rgba(255,255,255,0.7); backdrop-blur: sm; border-radius: 12px; padding: 3px 10px; border: 1px solid rgba(229, 62, 62, 0.05); }
        #map-container { height: 260px; width: 100%; border-radius: 1.5rem; margin-top: 1.5rem; border: 4px solid #fff; box-shadow: 0 4px 12px rgba(0,0,0,0.08); z-index: 10; }
        #phrase-modal { transition: all 0.3s ease-in-out; }
        .ledger-row { display: grid; grid-template-columns: 5.5rem 1fr; align-items: center; background: #fff; border: 1px solid #f3f4f6; border-radius: 1rem; padding: 0.6rem 0.8rem; margin-bottom: 0.5rem; gap: 0.5rem; overflow: hidden; }
        .ledger-row-label { font-size: 0.7rem; font-weight: 800; border-radius: 0.4rem; padding: 0.2rem 0; width: 100%; text-align: center; }
        .row-gray { background-color: #f3f4f6; color: #6b7280; }
        .row-orange { background-color: #ffedd5; color: #c2410c; }
        .ledger-row-input { width: 100%; min-width: 0; border: none; font-size: 1rem; font-weight: 600; color: #374151; outline: none; background: transparent; text-align: center; text-align-last: center; }
        .flex-1 p { line-height: 1.4; }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">
    <header id="app-header" class="bg-[#fcfaf2] pt-4 pb-2 px-5 sticky top-0 z-30 shadow-sm border-b border-orange-50 flex-shrink-0 text-center">
        <div class="text-center mb-1">
            <h1 class="text-[7px] tracking-[0.2em] text-gray-400 font-bold uppercase">PREMIUM TRAVEL GUIDE</h1>
            <h2 class="text-lg font-bold text-gray-800">æ²–ç¹©æ¥µè‡´ä¹‹æ—… <span class="text-[10px] font-normal text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded-full">2026</span></h2>
        </div>
        <div class="flex justify-center gap-3 mb-3" id="weather-info">
            <div class="weather-badge flex items-center gap-1.5">
                <span class="text-[8px] font-bold text-gray-500 uppercase">Today</span>
                <i id="w-icon-0" class="fas fa-circle-notch fa-spin text-orange-400 text-xs"></i>
                <span id="w-temp-0" class="text-xs font-mono font-bold text-gray-600">--Â°</span>
            </div>
            <div class="weather-badge flex items-center gap-1.5">
                <span class="text-[8px] font-bold text-gray-500 uppercase">Tomo</span>
                <i id="w-icon-1" class="fas fa-circle-notch fa-spin text-blue-400 text-xs"></i>
                <span id="w-temp-1" class="text-xs font-mono font-bold text-gray-600">--Â°</span>
            </div>
        </div>
        <div class="grid grid-cols-3 items-end min-h-[50px]">
            <div class="col-start-1"></div>
            <div id="date-picker-container" class="flex space-x-5 justify-center items-end pb-1"></div>
            <div class="flex justify-end space-x-3 pb-0.5">
                <button onclick="toggleView('checklist')" id="checklist-toggle" class="flex flex-col items-center text-gray-300">
                    <i class="fas fa-toolbox text-lg mb-0.5"></i>
                    <span class="text-[9px] font-bold">åŠ©æ‰‹</span>
                </button>
                <button onclick="toggleView('ledger')" id="ledger-toggle" class="flex flex-col items-center text-gray-300">
                    <i class="fas fa-wallet text-lg mb-0.5"></i>
                    <span class="text-[9px] font-bold">å¸³æœ¬</span>
                </button>
            </div>
        </div>
    </header>

    <main id="content" class="flex-1 overflow-y-auto p-5 pb-24 bg-[#fcfaf2]"></main>

    <div id="detail-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden flex items-end sm:items-center justify-center transition-opacity duration-300 opacity-0">
        <div class="bg-white w-full sm:max-w-md sm:rounded-2xl rounded-t-3xl overflow-hidden max-h-[85vh] flex flex-col transform translate-y-full transition-transform duration-300 ease-out">
            <div class="relative h-56 flex-shrink-0">
                <img id="modal-img" src="" class="w-full h-full object-cover">
                <button onclick="closeModal()" class="absolute top-4 right-4 bg-black bg-opacity-40 text-white rounded-full p-2 backdrop-blur-sm"><i class="fas fa-xmark"></i></button>
            </div>
            <div class="p-6 overflow-y-auto">
                <span id="modal-tag" class="text-[10px] font-bold tracking-widest uppercase bg-red-600 px-2 py-1 rounded text-white mb-2 inline-block"></span>
                <h3 id="modal-title" class="text-2xl font-bold text-gray-900 mb-2 leading-tight"></h3>
                <div id="modal-hours-box" class="text-xs text-gray-500 mb-4 pb-3 border-b border-gray-100 flex items-center"><i class="far fa-clock mr-2 text-red-400"></i><span id="modal-hours-text"></span></div>
                <p id="modal-desc" class="text-gray-600 leading-relaxed text-sm mb-6 whitespace-pre-line"></p>
                <div id="modal-parking-container" class="hidden mb-6 bg-blue-50 p-4 rounded-xl border border-blue-100">
                    <div class="flex justify-between items-center mb-1">
                        <h4 class="text-[10px] font-bold text-blue-600 uppercase"><i class="fas fa-parking mr-1"></i> åœè»ŠæŒ‡å¼• (è‡ªé§•å¿…çœ‹)</h4>
                        <a id="modal-parking-link" href="#" target="_blank" class="bg-blue-600 text-white text-[10px] px-2 py-1 rounded font-bold shadow-sm flex items-center gap-1"><i class="fas fa-location-arrow"></i> å°èˆª</a>
                    </div>
                    <p id="modal-parking" class="text-xs text-blue-800 leading-relaxed"></p>
                </div>
                <div id="modal-notes-container" class="hidden mb-6 bg-amber-50 p-4 rounded-xl border border-amber-100">
                    <h4 class="text-[10px] font-bold text-amber-600 uppercase mb-1"><i class="fas fa-pen-fancy mr-1"></i> é‡è¦è³‡è¨Š</h4>
                    <p id="modal-notes" class="text-xs text-amber-800 leading-relaxed mb-3 whitespace-pre-line"></p>
                    <div id="modal-link-btn" class="hidden"><a id="modal-pdf-link" href="#" target="_blank" class="flex items-center justify-center gap-2 bg-amber-600 text-white py-2 rounded-lg text-xs font-bold shadow-sm"><i class="fas fa-file-pdf"></i> æŸ¥çœ‹æ†‘è­‰</a></div>
                </div>
                <div id="modal-mapcode-btn" class="hidden bg-red-50 p-4 rounded-xl border border-red-100 flex items-center justify-between cursor-pointer mb-3">
                    <div class="flex items-center"><div class="bg-red-500 p-2 rounded-lg text-white mr-3 shadow-sm"><i class="fas fa-map-marked-alt"></i></div><div><p class="text-[9px] text-red-500 font-bold uppercase">Copy MapCode</p><p id="modal-mapcode" class="text-base font-mono font-bold text-red-900"></p></div></div><i class="far fa-copy text-red-400"></i>
                </div>
                <a id="modal-google-link" href="#" target="_blank" class="w-full bg-gray-900 text-white py-4 rounded-xl flex items-center justify-center font-bold text-sm shadow-md"><i class="fab fa-google mr-2 text-orange-400"></i> Google Maps å°èˆª</a>
            </div>
        </div>
    </div>

    <div id="phrase-modal" class="fixed inset-0 bg-black z-[60] hidden flex flex-col items-center justify-center p-8 text-center" onclick="closePhrase()">
        <p id="phrase-en" class="text-orange-400 text-lg mb-8 font-bold tracking-widest uppercase"></p>
        <p id="phrase-jp" class="text-white text-4xl font-bold leading-tight mb-6"></p>
        <p id="phrase-romaji" class="text-gray-500 text-sm italic"></p>
        <p class="absolute bottom-10 text-gray-600 text-[10px] uppercase tracking-widest">Tap anywhere to close</p>
    </div>

    <script>
        // --- æ ¸å¿ƒè®Šæ•¸ (å…¨éƒ¨æ¢å¾©) ---
        const startDate = new Date('2026-01-19T15:20:00');
        const members = ['CN', 'SW', 'William']; 
        const daysOfWeek = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];
        const SYNC_URL = 'https://script.google.com/macros/s/AKfycbwnAoDsbgiHImkf54L8jG0paehqET1gixBQxSSRwr_wW3cKDRMKcJ5K_QmkIspncwzfGA/exec';

        let currentDay = 1;
        let activeTab = 'itinerary';
        let expenses = JSON.parse(localStorage.getItem('okinawa_expenses') || '[]');
        let currentRate = parseFloat(localStorage.getItem('okinawa_jpy_rate') || '0.21');
        let checklistState = JSON.parse(localStorage.getItem('okinawa_checklist') || '{}');
        let map = null;

        // --- æ ¸å¿ƒè¡Œç¨‹è³‡æ–™ (ä¿®æ­£é‡è¤‡ key èˆ‡æ›è¡Œå•é¡Œ) ---
        const tripData = {
             1: [
                { time: "15:20", tag: "Departure", title: "å°ç£æ¡ƒåœ’æ©Ÿå ´èµ·é£›  (MM926)", icon: "fa-plane-departure", map: "æ¡ƒåœ’åœ‹éš›æ©Ÿå ´", desc: "é–‹å•Ÿå—åœ‹æ²–ç¹©æ¥µè‡´ä¹‹æ—…ã€‚å»ºè­°æ—…å®¢æ–¼èµ·é£›å‰2å°æ™‚æŠµé”æ¡ƒåœ’åœ‹éš›æ©Ÿå ´è¾¦ç†ç™»æ©Ÿèˆ‡è¡Œæè¨—é‹ã€‚é£›è¡Œæ™‚é–“ç´„1.5å°æ™‚ï¼Œå¯æ–¼æ©Ÿä¸Šç¨ä½œä¼‘æ¯", img: "https://images.unsplash.com/photo-1436491865332-7a61a109cc05?q=80&w=1000", lat: 25.079, lng: 121.234 },
                { time: "17:50", tag: "Arrival", title: "æŠµé”é‚£éœ¸æ©Ÿå ´ & æ­ä¹˜å–®è»Œ", icon: "fa-train-subway", map: "é‚£éœ¸æ©Ÿå ´", desc: " æŠµé”é‚£éœ¸ç©ºæ¸¯ã€‚å®Œæˆå…¥å¢ƒæ‰‹çºŒå¾Œï¼Œå‰å¾€åœ‹å…§ç·šèˆªå»ˆ 2 æ¨“æ­ä¹˜å–®è»Œé›»\n\nã€äº¤é€šæ”»ç•¥ã€‘\nç›®çš„åœ°ï¼šOmoromachi ç«™ (æ­Œç”ºç«™)ã€‚\nå‡ºå£ï¼šè«‹ç”±ã€Œè¥¿å£ã€å‡ºç«™ï¼Œæ­¥è¡Œå³å¯æŠµé”é£¯åº—èˆ‡ DFSã€‚\nç¥¨åƒ¹ï¼šç´„ 330 æ—¥åœ“ (Android å¤¥ä¼´è«‹æº–å‚™å¯¦é«” IC å¡æˆ–ç¾é‡‘)ã€‚", img: "https://upload.wikimedia.org/wikipedia/commons/e/e0/Okinawa-Monorail_Series1000_Asahimachi.jpg", lat: 26.206, lng: 127.646 },
                { time: "18:45", tag: "Hotel", title: "æ±æ©«INN é‚£éœ¸ Omoromachi ç«™å‰", icon: "fa-hotel", hours: "Check-in 15:00+", map: "æ±æ©«INN é‚£éœ¸ Omoromachi ç«™å‰", desc: "ç·Šé„°å–®è»Œæ­Œç”ºç«™ï¼Œåœ°ç†ä½ç½®å„ªè¶Šã€‚é£¯åº—æä¾›å…è²»æ—©é¤ï¼Œä¸”æ­£å°é¢å³æ˜¯ DFS ç§Ÿè»Šé»ï¼Œæ˜¯è‡ªé§•è¡Œç¨‹çš„æœ€ä½³åŸºåœ°ã€‚å‘¨é‚Šæœ‰æ–°éƒ½å¿ƒå•†åœˆã€å¤§åœ‹è—¥å¦èˆ‡è¶…å¸‚ï¼Œç”Ÿæ´»æ©Ÿèƒ½å¼·å¤§ã€‚", img: "https://image.kkday.com/v2/image/get/w_1900%2Cc_fit/s1.kkday.com/product_152772/20230923055533_i6bm4/jpg", notes: "è¨‚å–®ç·¨è™Ÿ: 5422314614\nåœ°å€ï¼šé‚£éœ¸å¸‚æ­Œç”º1-6-6\né›»è©±ï¼š+81-98-862-1045\nhttps://drive.google.com/file/d/1x6wEhdO34cDj6wGcgBg95QDzNLPSyOwA/view?usp=sharing", lat: 26.223, lng: 127.696 },
                { 
                    time: "19:30", tag: "Shopping", title: "æ–°éƒ½å¿ƒå•†åœˆ (Omoromachi)", icon: "fa-bag-shopping", map: "DFS NAHA Okinawa", hours: "10:00-22:00", desc: "é‚£éœ¸ç¾ä»£åŒ–è³¼ç‰©èˆ‡ç”Ÿæ´»ä¸­å¿ƒï¼Œé›†çµ DFSã€UQã€GUã€å®¶é›»èˆ‡ç¾é£Ÿé¤å»³ã€‚é‚„è»Šé»å°±åœ¨é£¯åº—å°é¢ã€‚", notes: "ã€æ–°éƒ½å¿ƒå¿…é€›æ¨è–¦ã€‘\n1. San-A Main Placeï¼šå¤§å‹è¶…å¸‚(2Fæœ‰ç”Ÿæ´»é›œè²¨)ã€Tokyu Handsã€Loft\n2. Edion (æ„›é›»ç‹)ï¼šå¹é¢¨æ©Ÿèˆ‡ç¾å®¹å®¶é›»é¦–é¸\n3. å¤§åœ‹è—¥å¦ï¼šç’°å¢ƒæ¯”åœ‹éš›é€šå¯¬æ•ï¼Œé©åˆé¦–æ™šå…ˆè²·è—¥å“\n4. å¤©ä¹…æ¨‚å¸‚(æ­¥è¡Œ10åˆ†)ï¼šæœ‰è¶…å¤§é–“ UNIQLO èˆ‡ ç„¡å°è‰¯å“", img: "https://www.tabirai.net/tabirai-uploader/img/0016739/s1_0016739.jpg", lat: 26.224, lng: 127.693, parking: "ã€ç„¡æ–™ã€‘Naha Main Place å¤§å‹åœè»Šå ´ã€‚", parkingLink: "https://maps.app.goo.gl/A2XzY2qG9Y2qG9Y2qG5",
                    subs: [ 
                        { type: "æ™šé¤", name: "ç›®åˆ©éŠ€æ¬¡", hours: "17:00-01:00",  map: "ç›®åˆ©ãã®éŠ€æ¬¡ æ–°éƒ½å¿ƒæœ¬èˆ—", desc: "ä½æ–¼æ–°éƒ½å¿ƒçš„æµ®èª‡ç³»å±…é…’å±‹ï¼Œè£æ½¢ä»¥å·¨å¤§æœ¨æ¡¶ç‚ºç‰¹è‰²ã€‚æµ·é®®æ¯æ—¥ç”±ç”¢åœ°ç›´é€ï¼Œé£Ÿææ°´æº–æ¥µé«˜ã€‚\n\nå»ºè­°å¿…åƒï¼šç”¢åœ°ç›´é€ç”Ÿé­šç‰‡æ‹¼ç›¤ (è¶…ä¾¿å®œ)ã€çƒ¤ç”Ÿè ”ã€æµ·è†½é£¯ç³°ã€‚", img: "https://mimigo.tw/wp-content/uploads/20190328181052_47.jpg" },
                        { type: "æ™šé¤", name: "ç„¼è‚‰ãã‚“ã", hours: "17:00-00:00",  map: "ç„¼è‚‰ãã‚“ã é‚£è¦‡æ–°éƒ½å¿ƒåº—", desc: "æ—¥å¼ç‡’è‚‰åƒåˆ°é£½é€£é–åº—ï¼Œä»¥é«˜CPå€¼èåï¼Œæä¾›å¤šç¨®åƒ¹ä½å¥—é¤ï¼Œå¾åŸºç¤æ¬¾åˆ°é ‚ç´šåœ‹ç”¢ç‰›çš†æœ‰ï¼ŒåŒ…å«äº”å¤§åç‰©ï¼ˆå¦‚å£ºæ¼¬ç‰›æ’ã€èŠ±å’²è‚‰ï¼‰ç­‰ç‰¹è‰²å“é …ï¼Œé‚„æœ‰å¹³æ¿é»é¤ã€æ›ç¶²ã€çµå¸³æ–¹ä¾¿ã€æŠ½ç…™è¨­å‚™å¥½ç­‰å„ªé»", img: "https://img.mimihan.tw/uploads/20190308152843_81.jpg" }
                    ]
                 }
            ],
            2: [
                { time: "09:00", tag: "Rental", title: "Orix ç§Ÿè»Šå–è»Š (Omoromachi ç«™å‰åº—)", hours: "09:00-19:00", icon: "fa-car", map: "DFS T Galleria", mapcode: "33 188 295*36", desc: "å‰å¾€é£¯åº—å°é¢çš„ Orix æ«ƒå°å–è»Šã€‚è»Šå‹ï¼šRA Class (Rocky æˆ–åŒç´š)ã€‚", img: "https://www.otsinternational.jp/otsrentacar/img/upload/car_office/4_dfs_1.png", notes: "é ç´„è™Ÿç¢¼ï¼šW7665353\nå–è»Šæ™‚é–“ï¼š1/20 09:00\nè¨˜å¾—å‡ºç¤ºï¼šé§•ç…§æ­£æœ¬+æ—¥æ–‡è­¯æœ¬\n\nã€é‡è¦æé†’ã€‘\n1. ç¢ºèªåˆç´„æ˜¯å¦åŒ…å« NOC (ä¿éšª)ã€‚\n2. æª¢æŸ¥è»Šèº«åˆ®ç—•ä¸¦æ‹ç…§ç´€éŒ„ã€‚", lat: 26.222, lng: 127.695, parking: "ã€æœ‰æ–™ã€‘DFS å¤§å‹åœè»Šå ´ï¼Œå–è»Šå®¢æˆ¶é€šå¸¸äº«æœ‰æŠ˜æŠµã€‚", parkingLink: "https://maps.app.goo.gl/f2XzY2qG9Y2qG9Y2qG5" },
                { 
                    time: "11:00", tag: "Island", title: "å¤å®‡åˆ©å¤§æ©‹ & å¤å®‡åˆ©å³¶", icon: "fa-bridge", map: "å¤å®‡åˆ©å¤§æ©‹ å—ç«¯è§€æ™¯å°", mapcode: "485 662 041*33", desc: "å¤å®‡åˆ©å¤§æ©‹æ˜¯ä¸€åº§å…¨é•· 1,960å…¬å°º çš„è·¨æµ·å¤§æ©‹ï¼Œé€£æ¥æ²–ç¹©æœ¬å³¶èˆ‡ã€Œç¥ä¹‹å³¶ã€å¤å®‡åˆ©å³¶ã€‚ä»¥å…¶å…©å´ä¸€æœ›ç„¡éš›çš„ç¿¡ç¿ ç¶ æµ·æ´‹æ™¯è§€è€Œèåï¼Œæ˜¯æ²–ç¹©æ¥µå—æ­¡è¿çš„è‡ªé§•å…œé¢¨è·¯ç·šã€‚å¤å®‡åˆ©å³¶æœ¬èº«ç”±çŠç‘šç¤å½¢æˆï¼Œå³¶ä¸Šæœ‰è¨±å¤šå€¼å¾—æ¢ç´¢çš„æ™¯é»ã€‚\n\nå¤å®‡åˆ©æµ·ç˜: ä½æ–¼å¤å®‡åˆ©äº¤æµå»£å ´æ—ï¼Œæœ‰è‘—ç¾éº—çš„æ²™ç˜å’Œå®Œå–„çš„è¨­æ–½ï¼Œæä¾›æ°´ä¸Šæ´»å‹•ã€‚\nå¤å®‡åˆ©æµ·æ´‹å¡”: ä½æ–¼å³¶ä¸Šé«˜è™•ï¼Œå¯ä»¥æ­ä¹˜è‡ªå‹•é§•é§›çš„é«˜çˆ¾å¤«çƒè»Šå‰å¾€å¡”é ‚ï¼Œä¿¯ç°å…¨å³¶åŠå¤å®‡åˆ©å¤§æ©‹çš„å£¯éº—æ™¯è‰²ã€‚", notes: "å»ºè­°é›¢é–‹æ™‚é–“: 12:30", img: "https://cdn.zekkei-japan.jp/images/articles/488e523c67776b1cf867452f7dc6008a.jpg", lat: 26.697, lng: 128.016, parking: "ã€ç„¡æ–™ã€‘æ©‹é ­å…©å´çš†æœ‰å¤§å‹å…è²»åœè»Šå ´ã€‚", parkingLink: "https://www.google.com/maps?q=26.678516272851443,128.01252369243755",
                    subs: [{ type: "åˆé¤", name: "å¤å®‡åˆ©è¦è¦é£¯", hours: "11:00-18:00", mapcode: "485 692 174*01", map: "Kouri Shrimp", desc: "ä½æ–¼å¤å®‡åˆ©å³¶çš„å°å±±å¡ä¸Šï¼Œä»¥å……æ»¿è’œé¦™èˆ‡å¥¶æ²¹é¦™æ°£çš„å¤å¨å¤·å¼è¦é¤é»èåï¼Œé…ä¸Šç„¡æ•µæµ·æ™¯æ˜¯è¦–è¦ºèˆ‡å‘³è¦ºçš„é›™é‡äº«å—ã€‚\n\nå»ºè­°å¿…åƒï¼šåŸå‘³è’œé¦™è¦é¤ (Garlic Shrimp Original)ã€è¾£å‘³åŠ é‡ç‰ˆã€‚", img: "https://cc.tvbs.com.tw/img/program/upload/2023/06/30/20230630153541-410273ba.jpg", parking: "ã€ç„¡æ–™ã€‘åº—é–€å£å‚™æœ‰ç´„ 10-15 å€‹å°ˆå±¬åœè»Šä½ã€‚", parkingLink: "https://www.google.com/maps?q=26.697052922006584,128.01990469118903" }]
                },
                { 
                    time: "13:30", tag: "Ocean", title: "ç¾éº—æµ·æ°´æ—é¤¨", icon: "fa-fish", map: "ç¾éº—æµ·æ°´æ—é¤¨", mapcode: "553 075 797*77", hours: "08:30-18:30", desc: "ä»¥ã€Œç¾éº—çš„æµ·æ´‹ã€ç‚ºä¸»é¡Œï¼Œå±•ç¤ºæ²–ç¹©è±å¯Œå¤šæ¨£çš„æµ·æ´‹ç”Ÿæ…‹ï¼Œå…¶ç‰¹è‰²æ˜¯å·¨å¤§çš„ã€Œé»‘æ½®ä¹‹æµ·ã€æ°´æ§½ï¼Œé£¼é¤Šè‘—ä¸–ç•Œæœ€å¤§é­šé¡é¯¨é¯Šèˆ‡é¬¼è é­Ÿï¼Œä¸¦æœ‰é™½å…‰ç‘è½çš„ã€ŒçŠç‘šä¹‹æµ·ã€å’Œç¥ç¥•çš„ã€Œæ·±æµ·ä¹‹æ—…ã€å€åŸŸï¼Œé‚„æœ‰å…è²»æµ·è±šç§€ã€æµ·é¾œé¤¨ç­‰å‘¨é‚Šè¨­æ–½ï¼Œæ˜¯é«”é©—æ²–ç¹©æµ·æ´‹é­…åŠ›çš„å¿…è¨ªä¹‹åœ°ã€‚", img: "https://images.unsplash.com/photo-1612476919598-a233d3692cc6?q=80&w=1170&auto=format&fit=crop", lat: 26.694, lng: 127.877, parking: "ã€ç„¡æ–™ã€‘è«‹å°èˆªè‡³ã€ŒP7 åŒ—å£ç«‹é«”åœè»Šå ´ã€ï¼Œé›¢å…¥å£æœ€è¿‘ã€‚", parkingLink: "https://www.google.com/maps?q=26.693894825102724,127.8795831187456",
                    subs: [
                        { type: "è¡¨æ¼”", name: "æµ·è±šç§€ (15:00 / 17:00)", hours: "ç´„20åˆ†é˜", desc: "ä»¥æ¹›è—å¤§æµ·ç‚ºèƒŒæ™¯çš„æˆ¶å¤–åŠ‡å ´ã€‚çœ‹è°æ˜çš„æµ·è±šå€‘å±•ç¾é©šäººçš„é«˜ç©ºå½ˆè·³ã€å”±æ­Œã€ä»¥åŠèˆ‡è¨“ç·´å“¡çš„å®Œç¾é»˜å¥‘ï¼Œæ­é…æ´»æ½‘çš„éŸ³æ¨‚ï¼Œæ˜¯ç¾éº—æµ·æœ€æ­¡æ¨‚çš„ç’°ç¯€ã€‚\n\nå ´æ¬¡æé†’ï¼š15:00 / 17:00ï¼ˆæ¯å ´ç´„ 20 åˆ†é˜ï¼‰ã€‚", img: "https://churaumi.okinawa/userfiles/images/area/surrounding/DSC02344.jpg" },
                        { type: "è¡¨æ¼”", name: "é¯¨é¯Šé¤µé£Ÿç§€ (15:00 / 17:00)", hours: "é»‘æ½®ä¹‹æµ·æ§½å‰", desc: "åœ¨å·¨å¤§çš„ã€Œé»‘æ½®ä¹‹æµ·ã€æ°´æ§½å‰ï¼Œçœ‹å…¨ä¸–ç•Œæœ€å¤§çš„é­šé¡ã€Œé¯¨é¯Šã€å‚ç›´åœ¨æ°´ä¸­é€²é£Ÿçš„éœ‡æ’¼ç¬é–“ã€‚æ•¸è¬æ¢é­šç¾¤è·Ÿéš¨ç©¿æ¢­ï¼Œå…‰å½±èˆ‡æ°´é¢çš„æµå‹•è®“äººå±æ¯ã€‚\n\nå ´æ¬¡æé†’ï¼š15:00 / 17:00ï¼ˆå»ºè­°æå‰ 15 åˆ†é˜åˆ°å ´ä½”ä½ï¼‰ã€‚", img: "https://assets.funliday.com/posts/wp-content/uploads/2023/03/05233404/IMG_8454-scaled.jpg" }
                    ]
                },
                { 
                    time: "19:00", tag: "Dinner", title: "ç¾åœ‹æ‘", icon: "fa-ferris-wheel", map: "ç¾åœ‹æ‘", mapcode: "33 526 450*63", hours: "10:00-22:00", desc: "ç”±ç¾è»åŸºåœ°æ­¸é‚„åœŸåœ°é–‹ç™¼è€Œæˆï¼Œå……æ»¿è‰²å½©ç¹½ç´›çš„ç¾å¼å»ºç¯‰ã€è¡—é ­è—è¡“èˆ‡ç•°åœ‹æ°›åœã€‚é€™è£¡é›†çµäº†ç´„350é–“å•†åº—ã€é¤å»³ã€é›»å½±é™¢ã€éŠæ¨‚å ´ï¼Œæä¾›ç¾å¼èˆ‡æ²–ç¹©ç‰¹è‰²ç¾é£Ÿã€‚\n\nDepot Islandï¼šç´…ç£šé“ã€ç•°åœ‹é¢¨å»ºç¯‰ï¼Œå……æ»¿æ™‚å°šæ„Ÿï¼Œæ˜¯æ‹ç…§ç†±é»ã€‚\nAmerica Depotï¼šç¾å¼å¾©å¤é¢¨æ ¼ï¼Œæœ‰è¨±å¤šç‰¹è‰²åº—èˆ–å’ŒéŠæˆ²ä¸­å¿ƒã€‚", img: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTiTfQo0lBlgTRpdltj6PVc5eW9G2C3yEnjJ1xGmWk4jOKmDTNTzZ2R_xqaPAyYjX5dMRSuV9NebKGmZ4-Mq_FJDrI3B2ET5Ayha8cSG77fo5rc-U4Nydp1NdGhsFkXBX0ZOXpsFZiu7I9jdCAv2FBpriMbWQHpuZ7PTNvKkc1rU7okfqbvRItGQvUmVjA/s1600-rw/Okinawa-American-Village-3.jpg", lat: 26.316, lng: 127.755, parking: "ã€ç„¡æ–™ã€‘åŒ—è°·ç”ºå…¬å…±åœè»Šå ´ï¼Œè»Šä½æ¥µå¤šä¸”å…è²»ã€‚", parkingLink: "https://www.google.com/maps?q=26.314869352936903,127.75960562346825",
                    subs: [
                        { type: "æ™šé¤", name: "è¿´è½‰å£½å¸å¸‚å ´", hours: "11:30-21:00", map: "è¿´è½‰å£½å¸å¸‚å ´ ç¾æµœåº—", desc: "ç¾åœ‹æ‘å…§çš„é«˜ CP å€¼å£½å¸åº—ï¼Œé£Ÿæçš†ç‚ºæ¼æ¸¯ç›´é€ï¼Œæ–°é®®åº¦èˆ‡ä»½é‡éƒ½è®“é€™å®¶åº—æˆç‚ºåŒ—è°·å€åŸŸçš„æ’éšŠååº—ã€‚\n\nå»ºè­°å¿…åƒï¼šæµ·é®®æ‹¼ç›¤ã€ç‚™ç‡’é˜¿å¤è±¬æ¡å£½å¸ã€æ²–ç¹©è¿‘æµ·ç”¢é‡‘æ§é­šã€‚", img: "https://img.poibank.com/SaGXj-6gjSM1TuYYdXJzs8NU7Kg=/W3siZm9ybWF0IjoianBnIn0seyJrZXkiOiJzdWdnZXN0aW9uLzI2NDM3NDQyLzEwNTAxNjI3LzE2OTE4NTY0NDI4MDIifSx7InJlc2l6ZSI6eyJ3aWR0aCI6IjE0NzcifX1d" },
                        { type: "æ™šé¤", name: "A&W æ¼¢å ¡", hours: "09:00-22:00", map: "A&W ç¾æµœåº—", desc: "æ—¥æœ¬ç¬¬ä¸€å®¶é€£é–é€Ÿé£Ÿåº—ï¼ˆåƒ…æ²–ç¹©é™å®šï¼‰ï¼Œå……æ»¿ 50 å¹´ä»£å¾©å¤ç¾å¼æ°£æ¯ã€‚\n\nå»ºè­°å¿…åƒï¼šéº¥æ ¹æ²™å£« (Root Beerï¼Œå¯ç„¡é™çºŒæ¯)ã€æ²æ²è–¯æ¢ (Curly Fries)ã€Mozza æ¼¢å ¡ã€‚", img: "https://pimg.1px.tw/muzuochen/1448980489-647390745.jpg" },
                        { type: "æ™šé¤", name: "Taco Rice Cafe Kijimuna", hours: "11:00-22:00", mapcode: "33 526 484*52", map: "ã‚¿ã‚³ãƒ©ã‚¤ã‚¹cafe ãã˜ã‚€ãªã ãƒ‡ãƒã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰åº—", desc: "ã€ç¾åœ‹æ‘å‰µå§‹ååº—ã€‘å¿…é»ã€æ­å§†è›‹å¡”å¯é£¯ (Omutaco)ã€ï¼æ»‘å«©åŠç†Ÿæ­å§†è›‹è¦†è“‹åœ¨è¾›é¦™å¡”å¯è‚‰é†¬é£¯ä¸Šï¼Œæ˜¯æ²–ç¹©æœ€å…·ä»£è¡¨æ€§çš„å‰µæ„æ–™ç†ã€‚\n\nä½æ–¼ Depot Island C æ£Ÿ 2 æ¨“ï¼Œè£æ½¢å……æ»¿ç•°åœ‹é¢¨æƒ…ï¼Œæä¾›ä¸åŒè¾£åº¦è‚‰é†¬å¯é¸æ“‡ã€‚", img: "https://www.depot-island.co.jp/depotisland/wp-content/uploads/2017/11/depotisland-DSC_4806.jpg" } 
                    ]
                }
            ],
            3: [
                { 
                    time: "11:00", tag: "Cave", title: "ç‰æ³‰æ´ / æ²–ç¹©ä¸–ç•Œ", icon: "fa-mountain-sun", map: "ç‰æ³‰æ´", mapcode: "232 495 330*28", hours: "09:00-17:30", desc: "æ­·ç¶“30è¬å¹´å½¢æˆçš„æ—¥æœ¬ç¬¬äºŒå¤§é˜ä¹³æ´ï¼Œæ“æœ‰è¶…éç™¾è¬æ ¹é˜ä¹³çŸ³èˆ‡ç¥ç§˜åœ°ä¸‹æ°´æ™¯è§€ï¼Œå…¨é•·5000å…¬å°ºï¼ŒéŠå®¢å¯æ¼«æ­¥æ–¼å°å¤–é–‹æ”¾çš„ç´„890å…¬å°ºæ­¥é“æ¬£è³å¥‡æ™¯ï¼›æ•´å€‹åœ’å€é‚„åŒ…å«é‡ç¾ç‰çƒå¤è€è¡—æ™¯çš„ã€Œç‹åœ‹æ‘ã€åŠã€Œæ¯’è›‡åšç‰©é¤¨ã€", notes: "å»ºè­°é›¢é–‹æ™‚é–“: 12:30", img: "https://images.unsplash.com/photo-1550992402-9b1fc58fd76d?q=80&w=1170", lat: 26.139, lng: 127.750, parking: "ã€ç„¡æ–™ã€‘åœ’å…§å¤§å‹å…è²»åœè»Šå ´ã€‚", parkingLink: "https://www.google.com/maps?q=26.14109125413903,127.74855684873619",
                    subs: [
                        { type: "è¡¨æ¼”", name: "12:30 å¤ªé¼“è¡¨æ¼”", hours: "ç´„30åˆ†é˜", desc: "å±•ç¾ç‰çƒå‚³çµ±ç¥­å…¸çš„åŠ›èˆ‡ç¾ï¼Œå¼·è€Œæœ‰åŠ›çš„é¼“è²ä¼´éš¨ç†±è¡€èˆå§¿ã€‚", img: "https://www.okitour.co.jp/uploads/contents/product/Ifz2McHD8" },
                        { type: "åˆé¤", name: "åœ’å€é¤å»³: Nantoå±‹", hours: "11:00-15:30", desc: "ã€Nantoå±‹ã€‘\nä»¥è±å¯Œçš„æ²–ç¹©é„‰åœŸæ–™ç†ç‚ºä¸»ï¼Œæä¾›å¤šæ¨£åŒ–çš„é¤é»é¸é …ï¼ŒåŒ…æ‹¬ç¶“å…¸çš„æ²–ç¹©éºµã€é˜¿å¤è±¬æ’å¥—é¤ã€å¤©å©¦ç¾…ç«¹ç± æµ·è˜Šæ¶¼éºµã€æ²–ç¹©æ¹¯è±†è…ç­‰å‚³çµ±æ²–ç¹©ç¾é£Ÿï¼Œæ­é…æ–°é®®çš„ç•¶åœ°é£Ÿæçƒ¹èª¿è€Œæˆï¼Œå®Œç¾å±•ç¾æ²–ç¹©çš„é£²é£Ÿæ–‡åŒ–ã€‚", img: "https://pimg.1px.tw/pfse64289/1734664181-1691562388-g.jpg" }
                    ]
                },
                { 
                    time: "14:00", tag: "Island", title: "å¥§æ­¦å³¶ (è²“å³¶)", icon: "fa-cat", map: "å¥§æ­¦å³¶", mapcode: "232 468 240*42", desc: "ä»¥å¤©å©¦ç¾…å’Œå³¶è²“èåçš„æ¼æ‘ã€‚è²·ä»½å¤©å©¦ç¾…ååœ¨æµ·é‚Šå ¤é˜²çœ‹æµ·ç™¼å‘†ï¼Œæ„Ÿå—æ²–ç¹©æ…¢ç¯€å¥ã€‚", notes: "å»ºè­°é›¢é–‹æ™‚é–“: 14:00", img: "https://intranet.travel4u.com.tw/eWeb_t4u/IMGDB/002294/002297/002436/00069241.JPG", lat: 26.129, lng: 127.773, parking: "ã€ç„¡æ–™ã€‘éæ©‹å¾Œå…©å´çš†æœ‰å»£å¤§åœè»Šç©ºåœ°ã€‚", parkingLink: "https://maps.app.goo.gl/71WMzXNjF4M7uPVS9",
                    subs: [
                        { type: "å°åƒ", name: "ä¸­æœ¬é®®é­šå¤©å©¦ç¾…åº—", hours: "10:30-18:00", mapcode: "232 467 296*62", desc: "å¥§æ­¦å³¶å‰µå§‹ååº—ï¼ä½åœ¨æ©‹é ­è·¯å£æœ€æ–¹ä¾¿ã€‚éºµè¡£åšå¯¦è‡ªå¸¶é¹¹å‘³ã€‚å¿…é»ï¼šæµ·è˜Šã€ç‚¸é­šã€‚æ’éšŠäººæ½®è¼ƒå¤šã€‚", img: "https://bobbyfun.tw/wp-content/uploads/pixnet/dca5de24f1e59791956c293bf67f30b1.jpg" },
                        { type: "å°åƒ", name: "å¤§åŸå¤©å©¦ç¾…åº—", hours: "11:00-17:30", mapcode: "232 467 491*51", desc: "æä¾›å®¤å…§åº§ä½å€ï¼Œä¸”åº—é–€å£å¸¸æœ‰å³¶è²“å‡ºæ²’ã€‚æ’éšŠå£“åŠ›è¼ƒå°ï¼Œé©åˆæƒ³åä¸‹ä¾†æ‚ é–’æ“¼è²“çš„æ—…å®¢ã€‚", img: "https://i0.wp.com/journey.tw/wp-content/uploads/20170902032934_44.jpg?resize=1100%2C731&quality=99&ssl=1" }
                    ]
                },
                { time: "15:30", tag: "Shrine", title: "æ³¢ä¸Šå®®", icon: "fa-torii-gate", map: "æ³¢ä¸Šå®®", mapcode: "33 185 022*00", hours: "09:00-17:00", desc: "æ·±åº¦é«”é©—ï¼šç¥ç¤¾åƒæ‹œã€è³¼è²·æ›¸åŒ…å¾¡å®ˆï¼Œä¸¦æ­¥è¡Œè‡³è‡¨æµ·é“è·¯æ©‹ä¸Šæ‹ä¸‹ã€æ‡¸å´–ç¥ç¤¾ã€å…¨æ™¯ï¼Œæœ€å¾Œä¸‹åˆ°æµ·ç˜è¸æµªã€‚", notes: "å»ºè­°é›¢é–‹æ™‚é–“: 16:30", img: "https://s3-ap-northeast-1.amazonaws.com/thegate/2021/02/09/18/08/05/namino_ue_gu_shrine.jpg", lat: 26.220, lng: 127.671, parking: "ã€æœ‰æ–™ã€‘æ¨è–¦ã€æ³¢ä¹‹ä¸Šç«‹é«”åœè»Šå ´ã€ï¼Œä½ç½®å¤šä¸”å¥½åœã€‚", parkingLink: "https://maps.app.goo.gl/t4QMeFqDEDv1ePvW6" },
                { time: "17:30", tag: "Task", title: "Orix é‚„è»Š (Omoromachi ç«™å‰åº—)", icon: "fa-gas-pump", map: "DFS T Galleria", mapcode: "33 188 293*08", desc: "åŠ æ»¿æ²¹å¾Œæ–¼ 19:00 é–‰åº—å‰æŠµé” Orix DFS åº—é‚„è»Šã€‚åŠ å®Œæ²¹å¾Œè«‹ä¿ç•™æ”¶æ“šã€‚æˆ–è€…åœ¨é‚„è»Šå£æ—æœ‰å¾®å‹åŠ æ²¹ç«™ã€‚", notes: "æ³¨æ„ 17:30 å¾Œ 58 åœ‹é“å…¬è»Šå°ˆç”¨é“é™åˆ¶ã€‚", img: "https://www.otsinternational.jp/otsrentacar/img/upload/car_office/4_dfs_1.png", lat: 26.222, lng: 127.695 },
                { 
                    time: "18:00", tag: "Night", title: "åœ‹éš›é€š æ•£ç­–", icon: "fa-person-walking", map: "åœ‹éš›é€š", hours: "10:00-22:00", desc: "è­½ç‚ºã€Œå¥‡è¹Ÿçš„ä¸€å“©è·¯ã€çš„é‚£éœ¸ç¬¬ä¸€è¡—ã€‚é€™æ¢å…¨é•·1.6å…¬é‡Œçš„è¡—é“åœ¨æˆ°å¾Œè¿…é€Ÿå¾©ç”¦ï¼Œç¾å·²æˆç‚ºæ²–ç¹©æœ€ç¹è¯çš„å•†æ¥­æ ¸å¿ƒã€‚è¡—é“å…©å´é›†çµäº†è±å¯Œçš„åœŸç”¢åº—ã€æ½®æµæœé£¾ã€è—¥å¦æ——è‰¦åº—èˆ‡å„å¼ä¸»é¡Œé¤å»³ï¼Œæ˜¯é«”é©—æ²–ç¹©ç†±æƒ…å¤œæ™šã€å°‹å¯¶æƒè²¨èˆ‡æ„Ÿå—å—åœ‹æ´»åŠ›çš„å¿…è¨ªå‹åœ°ã€‚", notes: "ã€åœ‹éš›é€šå¿…é€›ååº—ã€‘\n1. ç¦æœ¨å±‹ (Fukugiya)ï¼šå¿…è²·åŸå‘³/é»‘ç³–å¹´è¼ªè›‹ç³•\n2. é¦–é‡ŒçŸ³é¹¼ (SuiSavon)ï¼šè³ªæ„Ÿç²¾æ²¹çš‚èˆ‡è­·æ‰‹éœœ\n3. Calbee+ï¼šç¾ç‚¸ç´…èŠ‹è–¯æ¢ & æ²–ç¹©é™å®šè–¯æ¢æ¯\n4. é¹½å±‹ (Salt Ya)ï¼šé›ªé¹½å†°æ·‡æ·‹ & å„å¼èª¿å‘³é¹½\n5. é©šå®‰æ®¿å ‚ (å”å‰è¨¶å¾·)ï¼šæ·±å¤œè£œé½Šé›¶é£Ÿã€æ³¡éºµåŸºåœ°\n6. Sanrio å±‹ï¼šå‡±è’‚è²“æ²–ç¹©é™å®šå•†å“", img: "https://images.unsplash.com/photo-1647336963732-7446b9da7a6f?q=80&w=1170&auto=format&fit=crop", lat: 26.215, lng: 127.684,
                    subs: [
                        { type: "æ™šé¤", name: "åœ‹éš›é€šå±‹å°æ‘", hours: "11:00-23:00", mapcode: "33 157 444*55", map: "åœ‹éš›é€šå±‹å°æ‘", desc: "é›†çµäº† 20 é–“ç‰¹è‰²å°åº—ï¼Œå¾é“åœ°ç‰çƒæ–™ç†åˆ°å‰µæ„å±…é…’å±‹æ‡‰æœ‰ç›¡æœ‰ï¼Œæ˜¯æ„Ÿå—æ²–ç¹©ç†±é¬§æ·±å¤œé£Ÿå ‚æ°›åœçš„æœ€ä½³å»è™•ã€‚\n\nå»ºè­°å¿…åƒï¼šé˜¿å¤è±¬é¤ƒå­ (Agu Pork)ã€çŸ³å£ç‰›ä¸²ç‡’ã€æ³¡ç››èª¿é…’ã€‚", img: "https://static.gltjp.com/glt/data/directory/14000/13966/20221104_110633_5122610b_w1920.webp" },
                        { type: "æ™šé¤", name: "æš–æš®æ‹‰éºµ", hours: "10:00-02:00", mapcode: "33 157 590*44", map: "æš–æš®æ‹‰éºµ é‚£éœ¸ç‰§å¿—åº—", desc: "æ²–ç¹©æš–æš®æ‹‰éºµæ˜¯å°ç£äººæœ€æ„›çš„æ²–ç¹©æ‹‰éºµï¼Œæ›¾ç¶“æ“Šæ•—ã€Œä¸€è˜­ã€æ¦®ç²ä¹å·æ‹‰éºµæ¯”è³½å† è»å‘¢ï¼æš–æš®æ‹‰éºµä¸»æ‰“ç‰¹è£½è±šéª¨æ‹‰éºµï¼Œéºµçš„ç²—ç´°ã€éºµæ¢ç¡¬åº¦ã€æ¹¯é ­æ¿ƒéƒåº¦ã€æœ‰ç„¡é’è”¥è¾£é†¬ç­‰éƒ½å¯æ ¹æ“šå®¢äººå£å‘³èª¿æ•´ã€‚", img: "https://img.bigfang.tw/2018/09/1537266270-65954252bf4b4565feb4ea427a5203c8.jpg" },
                        { type: "æ™šé¤", name: "ç‰å®¶æ‹‰éºµ", hours: "11:30-00:00", mapcode: "33 157 187*60", map: "ç‰å®¶æ‹‰éºµ åœ‹éš›é€šæœ¬åº—", desc: "ç‰å®¶æ‹‰éºµæ˜¯è¿‘å¹¾å¹´å¾ˆäººæ°£çš„æ‹‰éºµåº—ï¼Œæœ€äººæ°£çš„å°±æ˜¯ã€Œç‰ç„¦è’œè±¬éª¨éºµã€ï¼Œé»‘è‰²æ¹¯é ­ç¬¬ä¸€çœ¼å°±ä»¤äººå°è±¡æ·±åˆ»ï¼Œé€™å€‹é»‘è‰²æ˜¯ä¾†è‡ªç”¨å¤§è’œå’Œæ´‹è”¥æ‹Œç‚’çš„é»‘è’œæ²¹ï¼Œç‰¹æ®Šçš„ç„¦é¦™å‘³æ˜¯è®“å¤§å®¶ä¸Šç™®çš„æœ€å¤§äº®é»ï¼", img: "https://valerieblog.tw/wp-content/uploads/2017/11/P6201520-e1596253022785.jpg" },
                        { type: "ç”œé»", name: "Blue Seal å†°æ·‡æ·‹", hours: "10:00-22:00", map: "Blue Seal åœ‹éš›é€š", desc: "æºè‡ªç¾åœ‹ã€åœ¨æ²–ç¹©ç™¼æšå…‰å¤§çš„æ¨™èªŒæ€§å“ç‰Œï¼Œçµåˆäº†ç¾å¼æ¿ƒéƒèˆ‡æ²–ç¹©åœ¨åœ°é£Ÿæï¼Œæ˜¯å—åœ‹æ¶ˆæš‘é¦–é¸ã€‚\n\nå»ºè­°å¿…åƒï¼šç´…èŠ‹ (Beni-imo)ã€æ²–ç¹©é¹½é®®å¥¶ (Okinawan Salt Cookies)ã€‚", img: "https://sydney-blog.com/wp-content/uploads/2024/06/s__64839791-197690351-e1718103592320.jpg?w=1400" },
                        { type: "ç”œé»", name: "KOI ThÃ© é£²æ–™åº—", hours: "10:00-21:00", map: "KOI ThÃ© åœ‹éš›é€š", desc: "æºè‡ªå°ç£çš„é«˜å“è³ªèŒ¶é£²å“ç‰Œï¼Œåœ¨é‚£éœ¸æ¥µå—æ­¡è¿ï¼Œé©åˆåœ¨é€›å®Œè¡—å¾Œè²·ä¸€æ¯å¸¶è‘—èµ°ã€‚\n\nå»ºè­°å¿…åƒï¼šé»ƒé‡‘çç å¥¶èŒ¶ã€çƒé¾æ‹¿éµã€‚", img: "https://i0.wp.com/carollin.tw/wp-content/uploads/20170418013350_6.jpg?ssl=1" }
                    ]
                }
            ],
                    
            4: [
                { time: "9:30", tag: "Stay", title: "é£¯åº— Checkout & å¯„æ”¾è¡Œæ", icon: "fa-suitcase", hours: "10:00 æˆªæ­¢", map: "æ±æ©«INN é‚£éœ¸ Omoromachi ç«™å‰", desc: "å®Œæˆé€€æˆ¿æ‰‹çºŒã€‚å› é£¯åº—å°±åœ¨å–®è»Œç«™æ—ï¼Œå¼·çƒˆå»ºè­°ç›´æ¥å°‡è¡Œæå¯„æ”¾åœ¨é£¯åº—æ«ƒæª¯ï¼Œå¾…ä¸‹åˆè¡Œç¨‹çµæŸå¾Œå†å›ä¾†é ˜å–æ­é›»è»Šå‰å¾€æ©Ÿå ´ã€‚", img: "https://image.kkday.com/v2/image/get/w_1900%2Cc_fit/s1.kkday.com/product_152772/20230923055533_i6bm4/jpg", notes: "ã€è¡Œæè™•ç†å»ºè­°ã€‘\n1. æ±æ©«INN æ«ƒæª¯å¯„æ”¾ (å…è²»ä¸”æœ€å®‰å…¨ç©©å®š)ã€‚", lat: 26.223, lng: 127.696 },
                { time: "10:00", tag: "Optional", title: "é¦–é‡ŒåŸ (å‚™æ¡ˆè¡Œç¨‹)", icon: "fa-landmark", map: "é¦–é‡ŒåŸ", mapcode: "33 161 526*66", hours: "08:30-18:00", desc: "è‹¥é«”åŠ›è¨±å¯ï¼Œæ­ä¹˜å–®è»Œé›»è»Šè‡³é¦–é‡Œç«™ï¼Œè¦‹è­‰å¾©èˆˆä¸­çš„ç‰çƒç‹åœ‹éºå€ã€‚è‹¥æƒ³æ‚ é–’é€›è¡—å‰‡å¯ç•¥éæ­¤é …ã€‚", img: "https://ohh.okinawa/wpdir/wp-content/uploads/2018/10/7ac047596507fadd22e23647ff3ae1d4.jpg", lat: 26.217, lng: 127.719 },
                { 
                    time: "11:00", tag: "Market", title: "ç¬¬ä¸€ç‰§å¿—å…¬è¨­å¸‚å ´", icon: "fa-store", map: "ç¬¬ä¸€ç‰§å¿—å…¬è¨­å¸‚å ´", mapcode: "33 157 323*52", hours: "08:00-21:00", desc: "ã€Œæ²–ç¹©äººçš„å»šæˆ¿ã€ï¼Œæ–¼ 2023 å¹´æ•´ä¿®ç¿»æ–°ã€‚å¯é«”é©—åœ¨äºŒæ¨“å°‡æ–°é®®é£Ÿæã€Œç¾è²·ç¾æ–™ç†ã€ï¼Œé«”é©—ç¨ç‰¹çš„æ²–ç¹©ç¾é£Ÿæ–‡åŒ–ã€‚", img: "https://guide-book-pic.s3.ap-southeast-2.amazonaws.com/makishi.jpeg", lat: 26.214, lng: 127.688,
                    subs: [
                        { type: "ç”œé»", name: "é¹½å±‹ (é›ªé¹½å†°æ·‡æ·‹)", hours: "10:00-20:00", map: "å¡©ã®å°‚é–€åº— å¡©å±‹ å›½éš›é€šã‚Šåº—", desc: "é¹¹ç”œäº¤ç¹”çš„å¤šå±¤æ¬¡é©šå–œæ»‹å‘³ã€‚å¿…åƒé›ªé¹½éœœæ·‡æ·‹ï¼Œæ¡Œä¸Šæœ‰åå¹¾ç¨®å£å‘³çš„ç‰¹è‰²é¹½ï¼ˆå¦‚å¯å¯ã€èŠ¥æœ«ã€æŠ¹èŒ¶é¹½ï¼‰å¯ä»¥è‡ªå·±æ’’è‘—åƒï¼", img: "https://bobbyfun.tw/wp-content/uploads/pixnet/8c114902489725d46a5d931b46e1a903.jpg" },
                        { type: "å°åƒ", name: "è±¬è‚‰è›‹é£¯ç³°", hours: "07:00-20:00", map: "Pork Tamago Onigiri Makishi Market", desc: "è±¬è‚‰è›‹é£¯ç³°ã€ŒPork Tamago Onigiriã€å°‡å…§æœ‰ spam ç½é ­ç«è…¿ã€åšåˆ‡ç‰å­ç‡’ï¼Œé‹ªä¸Šåšåšçš„ç™½é£¯åŠæµ·è‹”ï¼Œå°±æ˜¯æ»¿è¶³çš„ä¸€é¤ã€‚é™¤äº†åŸºæœ¬çš„åŸå‘³å¤–ï¼Œé‚„æœ‰ä½¿ç”¨æ²–ç¹©ç•¶åœ°é£Ÿæçš„è‹¦ç“œå¤©å©¦ç¾…ã€å¡”å¡”é†¬ç‚¸è¦ã€å‘³å™Œåšç‚¸å³¶è±†è…ç­‰å£å‘³ã€‚\n\nps.é‚£éœ¸æ©Ÿå ´åœ‹éš›ç·šç¾é£Ÿè¡—ä¹Ÿæœ‰åº—é¢", img: "https://alinalife.tw/wp-content/uploads/2024/01/20240128212935_0.jpg" },
                        { type: "åˆé¤", name: "æµ·é®®å¤§é¤ (ä»£å®¢æ–™ç†)", hours: "11:00-19:00", desc: "ä¸€æ¨“æŒ‘é¸ç”ŸçŒ›æµ·é®®ï¼ŒäºŒæ¨“äº¤ç”±é¤å»³ä»£å®¢æ–™ç†ï¼Œæ˜¯æ²–ç¹©æœ€å…·ä»£è¡¨æ€§çš„æµ·é®®é«”é©—ã€‚\n\nå»ºè­°å¿…åƒï¼šå¤œå…‰è² (æ²–ç¹©é™å®š)ã€é¾è¦ã€å·¨å‹æ‰‡è²ã€‚", img: "https://i1.wp.com/itravelblog.net/wp-content/uploads/2024/05/First-Makishi-Public-Market-16.jpg" }]
                },
                { time: "14:00", tag: "Transit", title: "å›é£¯åº—å–è¡Œæ&å‰å¾€æ©Ÿå ´", icon: "fa-train", map: "æ±æ©«INN é‚£éœ¸ Omoromachi ç«™å‰", desc: "æ­ä¹˜å–®è»Œé›»è»Šå›åˆ° Omoromachi ç«™é ˜å–è¡Œæï¼Œæ¥è‘—ç›´æ¥å‰å¾€é‚£éœ¸æ©Ÿå ´æº–å‚™å…¥é—œã€‚", img: "https://upload.wikimedia.org/wikipedia/commons/e/e0/Okinawa-Monorail_Series1000_Asahimachi.jpg", lat: 26.206, lng: 127.646 },
                { time: "16:50", tag: "Return", title: "é‚£éœ¸æ©Ÿå ´èµ·é£› (MM929)", icon: "fa-plane-arrival", map: "é‚£éœ¸æ©Ÿå ´", desc: "å¸¶è‘—æ»¿æ»¿å›æ†¶èˆ‡æˆ°åˆ©å“ï¼ŒçµæŸé€™è¶Ÿæ²–ç¹©æ¥µè‡´ä¹‹æ—…ã€‚æœŸå¾…ä¸‹æ¬¡å†è¦‹ï¼", img: "https://images.unsplash.com/photo-1436491865332-7a61a109cc05?q=80&w=1000" }
            ]
        };

        const packingList = [
            { cat: "éš¨èº«è¡Œæ", items: ["è­·è­·ç…§ (æ•ˆæœŸ6å€‹æœˆä»¥ä¸Š)", "éŒ¢åŒ…/å¤–å¹£ (2-3è¬æ—¥åœ“ç¾é‡‘)", "ICOCA/Suica (å¯æ‰‹æ©Ÿç¶å®š)", "é§•ç…§æ­£æœ¬+æ—¥æ–‡è­¯æœ¬", "æ©Ÿç¥¨/è¨‚æˆ¿/ç§Ÿè»Šæ†‘è­‰", "è¡Œå‹•é›»æº", "æ—¥æœ¬ç¶²å¡/eSIM", "å€‹äººè—¥å“", "å¤–å¥—/åœå·¾/å¸½å­", "ç›¸æ©Ÿ/è…³æ¶", "éš¨èº«é¢ç´™"] },
            { cat: "è¨—é‹è¡Œæ", items: ["å……é›»å™¨/è½‰æ¥é ­", "åˆ®é¬åˆ€", "ç‰™åˆ·/ç‰™è†", "æ›æ´—è¡£ç‰© (3-4å¥—)", "å…§è¡£è¤²/è¥ªå­", "ç¡è¡£", "æ‘ºç–Šå‚˜", "ç’°ä¿è³¼ç‰©è¢‹", "é«’è¡£æ”¶ç´è¢‹"] }
        ];
        // --- æŒ‡å®šæ ¼å¼ï¼šå“é …ï½œåœ°é» ---
        const shoppingList = [
            { cat: "æ²–ç¹©ä¼´æ‰‹ç¦® Top 15", items: [
                "å¾¡è“å­å¾¡æ®¿ ç´…èŠ‹å¡”ï½œåœ‹éš›é€šã€æ²–ç¹©æ©Ÿå ´",
                "å—é¢¨å ‚ è¾£å‘³è¦é¤…ï½œå”å‰è¨¶å¾·ã€åœŸç”¢åº—",
                "é‚ŠéŠ€é£Ÿå ‚ çŸ³å£å³¶è¾£æ²¹ï½œå”å‰è¨¶å¾·ã€è¶…å¸‚",
                "å®®å¤å³¶ é›ªé¹½ç³»åˆ—ï½œåœ‹éš›é€šé¹½å±‹ã€æ©Ÿå ´",
                "ç´”å¤©ç„¶ æ²–ç¹©é»‘ç³–ï½œå„åœŸç”¢åº—ã€æ©Ÿå ´",
                "Calbee+ é™å®šé›¶é£Ÿï½œåœ‹éš›é€šç›´ç‡Ÿåº—",
                "SuiSavon é¦–é‡ŒçŸ³é¹¼ï½œåœ‹éš›é€šã€ç™¾è²¨å°ˆæ«ƒ",
                "Royce çŸ³å£å³¶å·§å…‹åŠ›ï½œæ©Ÿå ´ã€åœ‹éš›é€š",
                "æ²–ç¹©é™å®š å³é£Ÿæµ·å¸¶èŠ½ï½œå”å‰è¨¶å¾·ã€åœŸç”¢åº—",
                "LuLuLun é™å®šé¢è†œï½œåœ‹éš›é€šå„å¤§è—¥å¦åº—",
                "Orion å•¤é…’åŠå…¶é›¶å˜´ï½œè¶…å¸‚ã€ä¾¿åˆ©å•†åº—",
                "Kabaya æ—¨é¹½é¤…ä¹¾æ£’ï½œåœŸç”¢åº—ã€è¶…å¸‚",
                "æ³¡ç››é…’ / è¾£æ¤’æ²¹ï½œå”å‰è¨¶å¾·ã€åœ‹éš›é€š",
                "Fukugiya å¹´è¼ªè›‹ç³•ï½œåœ‹éš›é€šé–€å¸‚",
                "æ²–ç¹©æ³¡éºµ (è¢‹è£)ï½œè¶…å¸‚ã€å”å‰è¨¶å¾·"
            ]}
        ];

        const phrases = [
            { j: "ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã—ã¾ã™", r: "O-kaikei o negai shimasu", e: "æˆ‘è¦çµå¸³" },
            { j: "ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹ï¼Ÿ", r: "Toire wa doko desu ka?", e: "å»æ‰€åœ¨å“ªï¼Ÿ" },
            { j: "ã“ã‚Œã‚’ãã ã•ã„", r: "Kore o kudasai", e: "è«‹çµ¦æˆ‘é€™å€‹" },
            { j: "äºˆç´„ã—ã¦ã„ã¾ã™", r: "Yoyaku shite imasu", e: "æˆ‘æœ‰é ç´„" },
            { j: "é§è»Šå ´ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", r: "Chuushajou wa arimasu ka?", e: "è«‹å•æœ‰åœè»Šå ´å—ï¼Ÿ" },
            { j: "å…ç¨ã«ãªã‚Šã¾ã™ã‹ï¼Ÿ", r: "Menzei ni narimasu ka?", e: "è«‹å•å¯ä»¥é€€ç¨…å—ï¼Ÿ" },
            { j: "é ˜åæ›¸ã‚’ãã ã•ã„", r: "Ryoushuusho o kudasai", e: "è«‹çµ¦æˆ‘æ”¶æ“š" }
        ];

        const emergencyContacts = [
            { name: "æ—¥æœ¬è­¦å¯Ÿå±€ (å ±æ¡ˆ)", tel: "110" },
            { name: "æ—¥æœ¬æ¶ˆé˜²/æ•‘è­·è»Š", tel: "119" },
            { name: "é§é‚£éœ¸è¾¦äº‹è™• (æ€¥é›£)", tel: "090-1942-1340" },
            { name: "é£¯åº— Omoromachi", tel: "098-862-1045" },
            { name: "Orix æ­Œç”ºç«™å‰åº—", tel: "098-862-0543" }
        ];
        
        const drivingRules = [
            { icon: "fa-bus", title: "å¹³æ—¥å…¬è»Šå°ˆç”¨é“ (é¿é–‹ 58 åœ‹é“/åœ‹éš›é€š)", time: "07:30-09:00 / 17:30-19:00", detail: "ç¶ è‰²è·¯é¢ç¦å…¥ï¼å¤©ä¹…è‡³æ—­æ©‹ã€åœ‹éš›é€šçš†æœ‰ç®¡åˆ¶ã€‚", color: "green" },
            { icon: "fa-arrows-alt-h", title: "ä¸­å¤®ç·šåç§» (ç¸£é“ 29 è™Ÿ)", time: "17:30 å¾Œé…ç½®è®Šå‹• (æ¾å· â‡„ å®‰é‡Œ)", detail: "æŠ¬é ­çœ‹ç‡ˆï¼äº®ç¶ ç®­é ­æ‰å¯é–‹ï¼Œå°å¿ƒé€†å‘ã€‚", color: "orange" },
            { icon: "fa-route", title: "è—è‰²è·¯é¢ (å³æŠ˜æ³¨æ„)", time: "å³è½‰å°å¼•è»Œè·¡", detail: "è«‹åˆ‡å…¥è—è‰²è»Šé“ä¸¦åœ¨æ¡†å…§ç­‰å¾…ç®­é ­ç‡ˆã€‚", color: "blue" },
            { icon: "fa-triangle-exclamation", title: "åŸºç¤èˆ‡å®‰å…¨æé†’ (æ­¢ã¾ã‚Œ/é›¨å¤©)", time: "ä¸€èˆ¬ 40-50 / é«˜é€Ÿ 80-100", detail: "ğŸ›‘åœæ­»3ç§’ã€‚é›¨å¤©è·¯é¢(çŠç‘šç¤è³ª)æ¥µæ»‘è«‹æ‹‰é•·è»Šè·ã€‚", color: "red" }
        ];

        // --- åŠŸèƒ½é‚è¼¯èˆ‡æ¸²æŸ“ ---
        async function fetchWeather() {
            try {
                const res = await fetch("https://api.open-meteo.com/v1/forecast?latitude=26.2124&longitude=127.6809&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=Asia%2FTokyo");
                const data = await res.json();
                for (let i = 0; i < 2; i++) {
                    const code = data.daily.weathercode[i];
                    document.getElementById(`w-temp-${i}`).textContent = `${Math.round(data.daily.temperature_2m_min[i])}Â°/${Math.round(data.daily.temperature_2m_max[i])}Â°`;
                    document.getElementById(`w-icon-${i}`).className = "fas " + getWeatherIcon(code);
                }
            } catch (e) {}
        }
        function getWeatherIcon(code) {
            if (code <= 1) return "fa-sun text-orange-400";
            if (code <= 3) return "fa-cloud-sun text-yellow-500";
            if (code <= 65) return "fa-cloud-showers-heavy text-blue-400";
            return "fa-cloud text-gray-400";
        }
        async function autoSyncFromCloud() {
            if (activeTab !== 'ledger') return;
            try {
                const res = await fetch(SYNC_URL);
                const data = await res.json();
                if (activeTab !== 'ledger') return; 
                if (data && data.length > 0) {
                    expenses = data;
                    localStorage.setItem('okinawa_expenses', JSON.stringify(expenses)); 
                    renderLedger();
                }
            } catch (e) {
                console.error("é›²ç«¯åŒæ­¥å¤±æ•—", e);
            }
        }
        async function syncToCloudSilently() {
            try { await fetch(SYNC_URL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(expenses) });
            } catch (e) {}
        }
        function initApp() { activeTab = 'itinerary'; renderDatePicker(); renderItinerary(); fetchWeather(); }
        function renderDatePicker() {
            const picker = document.getElementById('date-picker-container');
            if (!picker) return;
            picker.innerHTML = '';
            for (let i = 0; i < 4; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                const dayNum = i + 1;
                const div = document.createElement('div');
                div.className = `date-item flex flex-col items-center cursor-pointer ${dayNum === currentDay && activeTab === 'itinerary' ? 'active-date' : ''}`;
                div.onclick = () => { activeTab = 'itinerary'; currentDay = dayNum; toggleView('itinerary'); };
                div.innerHTML = `<span class="text-[8px] font-bold text-gray-400 uppercase">JAN</span><span class="text-[9px] font-bold">${daysOfWeek[date.getDay()]}</span><span class="text-xl date-num font-serif leading-none">${date.getDate()}</span><div class="date-dot"></div>`;
                picker.appendChild(div);
            }
        }
        function renderItinerary() {
            const container = document.getElementById('content');
            container.innerHTML = '';
            let html = '<div class="timeline-wrapper"><div class="timeline-line"></div>';
            tripData[currentDay].forEach(item => {
                let subsHtml = '';
                if (item.subs) {
                    item.subs.forEach(sub => {
                        const subStr = encodeURIComponent(JSON.stringify({...sub, tag: sub.type, title: sub.name}));
                        subsHtml += `<div class="sub-card" onclick="event.stopPropagation(); showModal('${subStr}')"><div class="flex justify-between mb-1"><span class="text-[9px] font-bold text-red-500 uppercase">${sub.type}</span><span class="text-[8px] text-gray-400 font-medium">${sub.hours || ''}</span></div><div class="text-sm font-bold text-gray-700">${sub.name}</div></div>`;
                    });
                }
                html += `<div class="relative mb-10 pl-10"><div class="timeline-dot"></div><div class="flex items-baseline mb-2"><span class="text-xl font-serif font-bold text-gray-800 mr-3">${item.time}</span><div class="h-[1px] flex-1 bg-orange-100"></div></div><div class="bg-white p-4 rounded-xl shadow-sm border border-orange-50 active:scale-95 transition-all" onclick="showModal('${encodeURIComponent(JSON.stringify(item))}')"><div class="flex items-center justify-between mb-1.5"><div class="flex items-center"><i class="fas ${item.icon} mr-2 text-red-400 text-xs"></i><span class="text-[9px] font-bold text-red-400 uppercase tracking-widest">${item.tag}</span></div>${item.hours ? `<span class="text-[9px] text-gray-400 font-medium">${item.hours}</span>` : ''}</div><h3 class="text-base font-bold text-gray-800 leading-tight">${item.title}</h3><p class="text-[11px] text-gray-400 mt-2 line-clamp-1 leading-relaxed">${item.desc}</p></div><div class="space-y-1">${subsHtml}</div></div>`;
            });
            container.innerHTML = html + '</div>';
            renderDailyMap();
        }
        function renderDailyMap() {
            const container = document.getElementById('content');
            const mapDiv = document.createElement('div');
            mapDiv.id = 'map-container';
            container.appendChild(mapDiv);
            if (map) map.remove();
            map = L.map('map-container', { zoomControl: false });
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { attribution: 'Â© OSM' }).addTo(map);
            const markers = [];
            tripData[currentDay].forEach((p, idx) => { if (p.lat && p.lng) { L.marker([p.lat, p.lng]).addTo(map).bindPopup(`<b style="color:#e53e3e">#${idx+1} ${p.title}</b>`); markers.push([p.lat, p.lng]); } });
            if (markers.length > 0) { const polyline = L.polyline(markers, {color: '#fca5a5', weight: 3, dashArray: '5, 10'}).addTo(map); map.fitBounds(polyline.getBounds(), { padding: [40, 40] }); }
        }

        function toggleView(view) {
            activeTab = view;
            const lt = document.getElementById('ledger-toggle');
            const ct = document.getElementById('checklist-toggle');
            // è™•ç†å°è¦½æŒ‰éˆ•é¡è‰²
            if (lt) lt.className = `flex flex-col items-center pb-0.5 transition-all ${activeTab === 'ledger' ? 'nav-btn-active' : 'text-gray-300'}`;
            if (ct) ct.className = `flex flex-col items-center pb-0.5 transition-all ${activeTab === 'checklist' ? 'nav-btn-active' : 'text-gray-300'}`;
            // æ ¹æ“šè¦–åœ–æ¸²æŸ“å…§å®¹
            if (view === 'ledger') {
                renderLedger();
                autoSyncFromCloud();
            } 
            else if (view === 'checklist') { 
                renderAssistant(); 
            } 
            else { 
                renderItinerary(); 
            }
            // ç„¡è«–åˆ‡æ›åˆ°å“ªï¼Œéƒ½æ›´æ–°æ—¥æœŸåˆ—çš„é¸ä¸­ç‹€æ…‹
            renderDatePicker();
        }

        function renderAssistant() {
            const container = document.getElementById('content');
            let html = `<div class="space-y-6">`;
            packingList.forEach(group => {
                html += `<div class="bg-white p-5 rounded-2xl shadow-sm border border-orange-100"><h3 class="text-sm font-bold text-red-500 mb-4 flex items-center uppercase tracking-wider"><i class="fas fa-check-circle mr-2"></i> ${group.cat}</h3><div class="space-y-3">`;
                group.items.forEach(item => {
                    const isChecked = checklistState[item] ? 'checked' : '';
                    html += `<label class="flex items-center justify-between p-3 bg-gray-50 rounded-xl transition-all active:bg-orange-50"><span class="text-sm font-medium text-gray-700">${item}</span><input type="checkbox" onchange="toggleCheckItem('${item}')" ${isChecked} class="w-5 h-5 accent-red-500"></label>`;
                });
                html += `</div></div>`;
            });
            shoppingList.forEach(group => {
    html += `<div class="bg-white p-5 rounded-2xl shadow-sm border border-blue-100"><h3 class="text-sm font-bold text-blue-500 mb-4 flex items-center uppercase tracking-wider"><i class="fas fa-shopping-bag mr-2"></i> ${group.cat}</h3><div class="space-y-2">`;
    group.items.forEach(item => {
        const parts = item.split('ï½œ');
        const isChecked = checklistState[item] ? 'checked' : '';
        html += `
            <label class="flex items-center p-2 bg-blue-50/30 rounded-xl transition-all active:bg-blue-100">
                <div class="flex flex-1 items-center overflow-hidden">
                    <span class="text-[12px] font-bold text-gray-800 w-[60%] shrink-0 tracking-tighter leading-tight pr-1 whitespace-nowrap overflow-hidden text-ellipsis">${parts[0]}</span>
                    
                    <span class="text-[9px] text-gray-400 flex-1 ml-1 border-l border-gray-200 pl-2 leading-tight py-0.5">${parts[1] || ''}</span>
                </div>
                <input type="checkbox" onchange="toggleCheckItem('${item}')" ${isChecked} class="w-4 h-4 accent-blue-500 ml-1 shrink-0">
            </label>`;
    });
    html += `</div></div>`;
});
            html += `<div class="bg-gray-800 p-5 rounded-2xl shadow-lg text-white"><h3 class="text-sm font-bold mb-4 flex items-center text-orange-400"><i class="fas fa-language mr-2"></i> å°ç™½æ²‰æµ¸å¼æ±‚æ•‘å¡</h3><div class="grid grid-cols-1 gap-3">`;
            phrases.forEach(p => { html += `<div class="bg-gray-700 p-4 rounded-xl active:scale-95 transition-all" onclick="showPhrase('${p.e}', '${p.j}', '${p.r}')"><p class="text-[10px] text-gray-400 mb-1 font-bold uppercase tracking-wider">${p.e}</p><p class="text-base font-bold">${p.j}</p></div>`; });
            html += '</div></div><div class="bg-white p-5 rounded-2xl shadow-sm border border-blue-100 mb-6"><h3 class="text-sm font-bold text-blue-700 mb-4 flex items-center uppercase tracking-wider"><i class="fas fa-shield-alt mr-2"></i> æ²–ç¹©è‡ªé§•é¿é›·æŒ‡å¼•</h3><div class="space-y-4">' + drivingRules.map(r => `<div class="flex gap-3 p-2 bg-${r.color}-50 rounded-lg"><div class="text-${r.color}-700 text-lg"><i class="fas ${r.icon}"></i></div><div class="flex-1"><p class="text-xs font-bold text-gray-800">${r.title}</p><p class="text-[10px] text-gray-600">${r.time}</p><p class="text-[10px] text-${r.color}-600 font-bold">${r.detail}</p></div></div>`).join('') + '<div class="grid grid-cols-2 gap-2 mt-2"><div class="text-[10px] bg-gray-100 p-2 rounded text-center">â¬…ï¸ å·¦å°è½‰ / â¡ï¸ å³å¤§è½‰</div><div class="text-[10px] bg-gray-100 p-2 rounded text-center">ğŸš„ å¹³äº¤é“ï¼šå…ˆåœçœ‹è½</div></div></div></div><div class="bg-red-50 p-5 rounded-2xl shadow-sm border border-red-100"><h3 class="text-xs font-bold text-red-600 mb-4 flex items-center uppercase tracking-widest"><i class="fas fa-phone-alt mr-2"></i> ç·Šæ€¥è¯çµ¡å°ˆå€</h3><div class="grid grid-cols-2 gap-3">';
            emergencyContacts.forEach(c => { html += `<div onclick="confirmCall('${c.name}', '${c.tel}')" class="bg-white p-3 rounded-xl border border-red-100 flex flex-col items-center justify-center active:bg-red-100 transition-all cursor-pointer"><span class="text-[10px] text-gray-500 font-bold mb-1">${c.name}</span><span class="text-xs font-mono font-bold text-red-600">${c.tel}</span></div>`; });
            html += `</div></div></div>`;
            container.innerHTML = html;
        }

        function renderLedger() {
    const container = document.getElementById('content');
    const todayStr = new Date().toISOString().split('T')[0];
    let balanceHtml = calculateBalances();
    
    container.innerHTML = `
        <div class="space-y-5">
            <div class="bg-white p-6 rounded-3xl border border-orange-50 shadow-sm space-y-3">
                <h3 class="text-base font-bold text-gray-800 flex items-center mb-2">
                    <i class="fas fa-plus-circle mr-2 text-red-400"></i> æ–°å¢æ”¯å‡º (è‡ªå‹•åŒæ­¥)
                </h3>
                
                <div class="ledger-row">
                    <span class="ledger-row-label row-gray">æ—¥æœŸ</span>
                    <input type="date" id="exp-date" value="${todayStr}" class="ledger-row-input font-mono">
                </div>
                
                <div class="ledger-row">
                    <span class="ledger-row-label row-orange">åŒ¯ç‡</span>
                    <input type="number" id="manual-rate" value="${currentRate}" step="0.001" onchange="updateRate(this.value)" class="ledger-row-input font-mono">
                </div>
                
                <div class="ledger-row">
                    <span class="ledger-row-label row-gray">é‡‘é¡</span>
                    <div class="flex items-center gap-2 flex-1 justify-center">
                        <select id="exp-currency" class="bg-gray-100 px-2 py-0.5 rounded font-bold text-xs">
                            <option value="TWD">TWD</option>
                            <option value="JPY">JPY</option>
                        </select>
                        <input type="number" id="exp-amount" placeholder="0" class="ledger-row-input" style="width: 80px; flex: none;">
                    </div>
                </div>
                
                <div class="ledger-row">
                    <span class="ledger-row-label row-gray">é …ç›®å…§å®¹</span>
                    <input type="text" id="exp-desc" placeholder="ä¾‹å¦‚ï¼šç‡’è‚‰ã€è—¥å¦" class="ledger-row-input">
                </div>
                
                <div class="ledger-row">
                    <span class="ledger-row-label row-gray">æ”¯ä»˜è€…</span>
                    <select id="exp-payer" class="ledger-row-input">
                        ${members.map(m => `<option value="${m}">${m}</option>`).join('')}
                    </select>
                </div>
                
                <div class="pt-2 text-center">
                    <span class="text-[10px] font-bold text-gray-400 tracking-widest uppercase block mb-2">åˆ†æ”¤å°è±¡</span>
                    <div class="flex justify-center gap-5">
                        ${members.map(m => `<label class="flex items-center gap-1 font-bold text-sm text-gray-600"><input type="checkbox" name="split-member" value="${m}" checked class="accent-red-500 w-4 h-4"> ${m}</label>`).join('')}
                    </div>
                </div>
                
                <button onclick="addExpense()" class="w-full bg-red-500 text-white py-4 rounded-2xl font-bold shadow-lg active:scale-95 transition-all mt-4">å„²å­˜ç´€éŒ„</button>
            </div>
            
            <div class="bg-amber-50/50 p-5 rounded-3xl border border-amber-100">
                <span class="ledger-row-label row-orange mx-auto block w-max mb-3 uppercase">Settlement (TWD)</span>
                <div class="space-y-2">${balanceHtml}</div>
            </div>
            
            <div class="space-y-3 pb-10" id="expense-list">${renderExpenseList()}</div>
        </div>`;
}

        async function addExpense() {
            const amount = parseFloat(document.getElementById('exp-amount').value); const currency = document.getElementById('exp-currency').value; const desc = document.getElementById('exp-desc').value; const payer = document.getElementById('exp-payer').value; const date = document.getElementById('exp-date').value; const checkedBoxes = document.querySelectorAll('input[name="split-member"]:checked'); const splitWith = Array.from(checkedBoxes).map(cb => cb.value);
            if (!amount || !desc || splitWith.length === 0) { alert('è«‹å¡«å¯«å®Œæ•´è³‡è¨Š'); return; }
            const twdAmount = (currency === 'JPY' ? amount * currentRate : amount);
            expenses.unshift({ id: Date.now(), date, amount, currency, twdAmount, desc, payer, splitWith }); localStorage.setItem('okinawa_expenses', JSON.stringify(expenses)); 
            renderLedger(); await syncToCloudSilently();
        }
        function deleteExpense(id) { expenses = expenses.filter(e => e.id !== id); localStorage.setItem('okinawa_expenses', JSON.stringify(expenses)); renderLedger(); syncToCloudSilently(); }
        function calculateBalances() { let totals = {}; members.forEach(m => totals[m] = 0); expenses.forEach(exp => { const perPerson = exp.twdAmount / exp.splitWith.length; totals[exp.payer] += exp.twdAmount; exp.splitWith.forEach(m => { totals[m] -= perPerson; }); }); return members.map(m => `<div class="flex justify-between font-bold bg-white p-3 rounded-xl shadow-sm border border-gray-100"><span>${m}</span><span class="${Math.round(totals[m]) >= 0 ? 'text-green-600' : 'text-red-500'}">${Math.round(totals[m]) >= 0 ? 'æ‡‰æ”¶å›' : 'æ‡‰æ”¯ä»˜'} $${Math.abs(Math.round(totals[m]))}</span></div>`).join(''); }
        function renderExpenseList() { if (expenses.length === 0) return '<div class="text-center text-gray-300 py-10 text-sm font-bold">å°šç„¡ç´€éŒ„</div>'; return expenses.map(exp => `<div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex justify-between items-center mb-2"><div><div class="text-[10px] text-gray-400 font-bold mb-1 font-mono text-xs">${exp.date}</div><div class="text-sm font-bold text-gray-800">${exp.desc}</div><div class="text-[9px] text-gray-400 font-bold uppercase mt-1">${exp.payer} æ”¯ä»˜ ${exp.amount} ${exp.currency}</div></div><div class="text-right flex items-center gap-3"><span class="text-xs font-mono font-bold text-gray-600">â‰ˆ $${Math.round(exp.twdAmount)}</span><button onclick="deleteExpense(${exp.id})" class="text-gray-200 hover:text-red-400"><i class="fas fa-trash-alt"></i></button></div></div>`).join(''); }
        function updateRate(val) { currentRate = parseFloat(val) || 0.21; localStorage.setItem('okinawa_jpy_rate', currentRate); }

        function showModal(itemStr) {
            const item = JSON.parse(decodeURIComponent(itemStr));
            const modal = document.getElementById('detail-modal');
            document.getElementById('modal-img').src = item.img;
            document.getElementById('modal-tag').textContent = item.tag || 'INFO';
            document.getElementById('modal-title').textContent = item.title;
            document.getElementById('modal-desc').textContent = item.desc;
            document.getElementById('modal-hours-text').textContent = item.hours || 'ä¾ç¾å ´å…¬å‘Šç‚ºä¸»';
            const pc = document.getElementById('modal-parking-container');
            if (item.parking) {
                document.getElementById('modal-parking').textContent = item.parking;
                document.getElementById('modal-parking-link').href = item.parkingLink || "#";
                pc.classList.remove('hidden');
            } else pc.classList.add('hidden');
            const nc = document.getElementById('modal-notes-container');
            const pdfBtn = document.getElementById('modal-link-btn');
            if (item.notes) {
                const urlMatch = item.notes.match(/https?:\/\/[^\s]+/);
                if (urlMatch) {
                    document.getElementById('modal-pdf-link').href = urlMatch[0];
                    pdfBtn.classList.remove('hidden');
                    document.getElementById('modal-notes').textContent = item.notes.replace(urlMatch[0], '').trim();
                } else { pdfBtn.classList.add('hidden'); document.getElementById('modal-notes').textContent = item.notes; }
                nc.classList.remove('hidden');
            } else nc.classList.add('hidden');
            const mc = document.getElementById('modal-mapcode-btn');
            if (item.mapcode) { document.getElementById('modal-mapcode').textContent = item.mapcode; mc.classList.remove('hidden'); mc.onclick = () => { navigator.clipboard.writeText(item.mapcode); alert('MapCode å·²è¤‡è£½ï¼'); }; } else mc.classList.add('hidden');
            document.getElementById('modal-google-link').href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.map || item.title)}`;
            modal.classList.remove('hidden'); setTimeout(() => { modal.classList.remove('opacity-0'); modal.querySelector('div').classList.remove('translate-y-full'); }, 10);
            document.body.style.overflow = 'hidden';
        }
        function closeModal() { const modal = document.getElementById('detail-modal'); modal.classList.add('opacity-0'); modal.querySelector('div').classList.add('translate-y-full'); setTimeout(() => { modal.classList.add('hidden'); document.body.style.overflow = ''; }, 300); }
        function showPhrase(e, j, r) { document.getElementById('phrase-en').textContent = e; document.getElementById('phrase-jp').textContent = j; document.getElementById('phrase-romaji').textContent = r; document.getElementById('phrase-modal').classList.remove('hidden'); }
        function closePhrase() { document.getElementById('phrase-modal').classList.add('hidden'); }
        function confirmCall(name, tel) { if (confirm(`ç¢ºå®šè¦æ’¥æ‰“é›»è©±çµ¦ã€Œ${name}ã€å—ï¼Ÿ`)) { window.location.href = `tel:${tel}`; } }
        function toggleCheckItem(item) { checklistState[item] = !checklistState[item]; localStorage.setItem('okinawa_checklist', JSON.stringify(checklistState)); }
        window.addEventListener('load', initApp);
    </script>
</body>
</html>























